# Query/Action/Solo æ¶æ§‹è¨­è¨ˆæ–‡æª”

## æ¦‚è¿°

æœ¬æ–‡æª”è©³ç´°èªªæ˜ Query/Action/Solo ä¸‰æ¨¡å¼æ¡†æ¶çš„æ¶æ§‹è¨­è¨ˆã€æŠ€è¡“å¯¦ç¾èˆ‡è¨­è¨ˆæ±ºç­–ã€‚

---

## è¨­è¨ˆç†å¿µ

### æ ¸å¿ƒå•é¡Œ

å‚³çµ± AI åŠ©æ‰‹é¢è‡¨çš„æŒ‘æˆ°ï¼š
1. **å®‰å…¨æ€§ä¸è¶³**ï¼šå®¹æ˜“èª¤åŸ·è¡Œé«˜é¢¨éšªæ“ä½œ
2. **å¯æ§æ€§å·®**ï¼šé›£ä»¥é æ¸¬ AI è¡Œç‚º
3. **ç©©å®šæ€§ä½**ï¼šé•·æ™‚é‹è¡Œæ˜“å‡ºéŒ¯æˆ–å¹»è¦º
4. **æºé€šæ•ˆç‡ä½**ï¼šå›è¦†å†—é•·æˆ–éæ–¼ç°¡ç•¥

### è¨­è¨ˆåŸå‰‡

1. **å®‰å…¨å„ªå…ˆ**ï¼šé è¨­ä¿å®ˆï¼Œæ˜ç¢ºæˆæ¬Šæ‰åŸ·è¡Œ
2. **æ¨¡å¼åˆ†é›¢**ï¼šæŸ¥è©¢èˆ‡åŸ·è¡Œæ¸…æ™°å€åˆ†
3. **é›™é‡ç¢ºèª**ï¼šé«˜é¢¨éšªæ“ä½œéœ€äºŒæ¬¡æˆæ¬Š
4. **å¯è§€å¯Ÿæ€§**ï¼šcheckpointã€audit logã€rollback
5. **è¨Šæ¯å¯†åº¦**ï¼šç¹é«”ä¸­æ–‡ç‚ºä¸»ï¼ˆè¨Šæ¯å¯†åº¦é«˜ï¼‰+ è‹±æ–‡å°ˆæ¥­è¡“èª

---

## æ¶æ§‹åœ–

## æ¶æ§‹åœ–

### æ•´é«”æ¶æ§‹

![æ•´é«”æ¶æ§‹åœ–](../diagrams/architecture.png)

<details>
<summary>ç´”æ–‡å­—ç‰ˆæœ¬ï¼ˆé»æ“Šå±•é–‹ï¼‰</summary>

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚           ä½¿ç”¨è€…è¼¸å…¥ï¼ˆUser Inputï¼‰                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                        â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚       å¤šä»»å‹™æª¢æ¸¬ï¼ˆMulti-task Detectionï¼‰          â”‚
â”‚   åµæ¸¬ï¼šã€Œå’Œã€ã€Œé‚„æœ‰ã€ã€Œä»¥åŠã€ã€é€—è™Ÿã€ç·¨è™Ÿ          â”‚
â”‚   â†’ æ˜¯å¤šä»»å‹™ï¼Ÿâ†’ è®€å–/æ›´æ–° TASK_TRACKER.md        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                        â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         è§¸ç™¼è©æª¢æ¸¬ï¼ˆTrigger Detectionï¼‰           â”‚
â”‚   Solo æˆæ¬Šè©ï¼Ÿâ†’ Action æˆæ¬Šè©ï¼Ÿâ†’ é è¨­ Query      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                        â†“
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â†“               â†“               â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Query Mode   â”‚ â”‚ Action Mode  â”‚ â”‚  Solo Mode   â”‚
â”‚              â”‚ â”‚              â”‚ â”‚              â”‚
â”‚ â€¢ Summary    â”‚ â”‚ â€¢ é åŸ·è¡Œç¢ºèª  â”‚ â”‚ â€¢ é•·æ™‚é‹è¡Œ    â”‚
â”‚ â€¢ å»ºè­°æ–¹æ¡ˆ    â”‚ â”‚ â€¢ é¢¨éšªåˆ†ç´š    â”‚ â”‚ â€¢ Self-test  â”‚
â”‚ â€¢ ç¦æ­¢åŸ·è¡Œ    â”‚ â”‚ â€¢ é›™é‡æˆæ¬Š    â”‚ â”‚ â€¢ Checkpoint â”‚
â”‚ â€¢ ä»»å‹™ä½‡åˆ—    â”‚ â”‚ â€¢ ä»»å‹™é€²åº¦    â”‚ â”‚ â€¢ ä»»å‹™è¿½è¹¤    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â†“               â†“               â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚          TASK_TRACKER.mdï¼ˆä»»å‹™è¿½è¹¤ï¼‰              â”‚
â”‚  â€¢ ä»»å‹™ä½‡åˆ—ï¼ˆå¾…è™•ç†/é€²è¡Œä¸­/å·²å®Œæˆï¼‰                â”‚
â”‚  â€¢ ä»»å‹™å„ªå…ˆç´šèˆ‡ä¾è³´é—œä¿‚                          â”‚
â”‚  â€¢ åŸ·è¡Œé€²åº¦èˆ‡æ™‚é–“æˆ³è¨˜                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â†“               â†“               â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚           æ ¼å¼åŒ–è¼¸å‡ºï¼ˆFormatted Outputï¼‰          â”‚
â”‚   Query: ç¹ä¸­ Summary-first                      â”‚
â”‚   Action: åŸ·è¡Œæ‘˜è¦ + Audit log                   â”‚
â”‚   Solo: é€²åº¦å ±å‘Š + Checkpoint                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

</details>

### æ¨¡å¼åˆ‡æ›ç‹€æ…‹æ©Ÿ

```
     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
     â”‚   é–‹å§‹      â”‚
     â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
            â†“
     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”Œâ”€â†’â”‚ Query Mode  â”‚â†â”€â”€â”
  â”‚  â”‚  (é è¨­)      â”‚   â”‚
  â”‚  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜   â”‚
  â”‚         â”‚           â”‚
  â”‚  æª¢æ¸¬æˆæ¬Šè©         â”‚
  â”‚         â”‚           â”‚
  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”   â”‚
  â”‚  â”‚ Action æˆæ¬Šï¼Ÿâ”‚   â”‚
  â”‚  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜   â”‚
  â”‚    æ˜¯ â†“   å¦        â”‚
  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”   â”‚
  â”‚  â”‚ Action Mode â”‚â”€â”€â”€â”˜
  â”‚  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜   å®Œæˆ/å–æ¶ˆ
  â”‚         â”‚           
  â”‚  æª¢æ¸¬ Solo æˆæ¬Š    
  â”‚         â”‚           
  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”   
  â”‚  â”‚ Solo æˆæ¬Šï¼Ÿ  â”‚   
  â”‚  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜   
  â”‚    æ˜¯ â†“   å¦        
  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”   
  â””â”€â”€â”‚  Solo Mode  â”‚â”€â”€â”€â”˜
     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   å®Œæˆ/æš«åœ
```

---

## æ¨¡å¼è©³è§£

### Query Modeï¼ˆæŸ¥è©¢æ¨¡å¼ï¼‰

**è¼¸å…¥è™•ç†æµç¨‹ï¼š**
```
ä½¿ç”¨è€…è¼¸å…¥
    â†“
èªç¾©ç†è§£ï¼ˆSemantic Understandingï¼‰
    â†“
éœ€æ±‚æ˜ç¢ºï¼Ÿ
â”œâ”€ æ˜¯ â†’ åˆ†æå•é¡Œ â†’ ç”¢ç”Ÿå»ºè­°
â””â”€ å¦ â†’ æå‡º Clarifying Question
    â†“
æ ¼å¼åŒ–è¼¸å‡ºï¼ˆSummary-firstï¼‰
    â†“
ç­‰å¾…ä½¿ç”¨è€…å›æ‡‰
```

**è¼¸å‡ºæ ¼å¼è¦ç¯„ï¼š**
```markdown
æ¨™é¡Œï¼š[ä¸€è¡Œæ¦‚æ‹¬]
æ‘˜è¦ï¼š[1â€“2 å¥é‡é»ï¼Œâ‰¤200 å­—]
è¦é»ï¼š
1. [è¦é» 1ï¼Œâ‰¤20 å­—]
2. [è¦é» 2ï¼Œâ‰¤20 å­—]
3. [è¦é» 3ï¼Œâ‰¤20 å­—]

ï¼ˆé è¨­ä¸å±•é–‹è©³ç´°å…§å®¹ï¼‰
```

**ç¦æ­¢è¡Œç‚ºæ¸…å–®ï¼š**
- âŒ ä¿®æ”¹ä»»ä½•æª”æ¡ˆ
- âŒ åŸ·è¡Œä»»ä½•ç³»çµ±å‘½ä»¤
- âŒ èª¿ç”¨å¤–éƒ¨å·¥å…·/API
- âŒ è‡ªå‹•å»ºç«‹å ±å‘Šæª”æ¡ˆ
- âŒ è¼¸å‡ºå…§å¿ƒç¨ç™½ï¼ˆchain-of-thoughtï¼‰

---

### Action Modeï¼ˆåŸ·è¡Œæ¨¡å¼ï¼‰

**åŸ·è¡Œæµç¨‹åœ–ï¼š**
```
åµæ¸¬åˆ°æˆæ¬Šè©
    â†“
æå–åŸ·è¡Œæ„åœ–ï¼ˆIntent Extractionï¼‰
    â†“
é¢¨éšªè©•ä¼°ï¼ˆRisk Assessmentï¼‰
    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   é¢¨éšªåˆ†ç´š      â”‚
â”‚ A / B / C ?     â”‚
â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     â”‚
     â”œâ”€ A â†’ ç”¢ç”Ÿé åŸ·è¡Œç¢ºèª â†’ ç­‰å¾…äºŒæ¬¡ç¢ºèª â†’ åŸ·è¡Œ
     â”œâ”€ B â†’ è©³ç´°èªªæ˜é¢¨éšª â†’ ç­‰å¾…æ˜ç¢ºæˆæ¬Š â†’ åŸ·è¡Œ
     â””â”€ C â†’ æ‹’çµ• + èªªæ˜ç†ç”±
          â†“
     åŸ·è¡Œ & é©—è­‰
          â†“
     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”
     â”‚ é©—è­‰é€šéï¼Ÿâ”‚
     â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜
          â”œâ”€ æ˜¯ â†’ å›å ±æˆåŠŸæ‘˜è¦
          â””â”€ å¦ â†’ å›æ»¾è‡³ checkpoint â†’ å›å ±éŒ¯èª¤
```

**é¢¨éšªè©•ä¼°æ¼”ç®—æ³•ï¼š**
```python
def assess_risk(changes):
    # C ç´šæª¢æŸ¥ï¼ˆæœ€é«˜å„ªå…ˆï¼‰
    if has_sensitive_data(changes):
        return 'C'
    if has_permission_change(changes):
        return 'C'
    if has_deletion(changes):
        return 'C'
    
    # B ç´šæª¢æŸ¥
    if file_count(changes) > 3:
        return 'B'
    if has_api_change(changes):
        return 'B'
    if has_db_schema_change(changes):
        return 'B'
    if has_breaking_change(changes):
        return 'B'
    
    # A ç´šï¼ˆé è¨­å®‰å…¨ï¼‰
    return 'A'
```

**é©—è­‰æ©Ÿåˆ¶ï¼š**
```
åŸ·è¡Œè®Šæ›´
    â†“
å…§éƒ¨é©—è­‰ï¼ˆJSON schema validationï¼‰
    â†“
å¤–éƒ¨é©—è­‰ï¼ˆUnit tests / Integration testsï¼‰
    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ å…¨éƒ¨é€šéï¼Ÿâ”‚
â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜
     â”œâ”€ æ˜¯ â†’ Commit & å›å ±
     â””â”€ å¦ â†’ Rollback & å›å ±éŒ¯èª¤
          â†“
     é€£çºŒå¤±æ•— 3 æ¬¡ï¼Ÿ
          â”œâ”€ æ˜¯ â†’ åˆ‡æ›è‡³ Query Mode + Alert
          â””â”€ å¦ â†’ ç­‰å¾…ä½¿ç”¨è€…æŒ‡ç¤º
```

---

### Solo Modeï¼ˆè‡ªä¸»æ¨¡å¼ï¼‰

**é•·æ™‚é‹è¡Œæ¶æ§‹ï¼š**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              Solo Controller                â”‚
â”‚  â€¢ Task Queue                               â”‚
â”‚  â€¢ Progress Tracker                         â”‚
â”‚  â€¢ Health Monitor                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â†“
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â†“                   â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Sandbox  â”‚      â”‚ Main Env â”‚
â”‚ Executor â”‚ â”€â”€â”€â†’ â”‚ Deployer â”‚
â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     â”‚
     â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Self-testâ”‚      â”‚Checkpointâ”‚
â”‚  Runner  â”‚      â”‚  Manager â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**Health Check æ©Ÿåˆ¶ï¼š**
```python
class HealthMonitor:
    def __init__(self):
        self.last_progress_time = now()
        self.error_count = 0
        self.checkpoint_interval = 10  # minutes
        
    def check_health(self):
        # æª¢æŸ¥ 1: é€²åº¦è¶…æ™‚
        if now() - self.last_progress_time > 120:  # 2 hours
            self.alert("No progress for 2 hours")
            return False
        
        # æª¢æŸ¥ 2: éŒ¯èª¤ç‡éé«˜
        if self.error_count > 5:
            self.alert("Error count exceeded threshold")
            return False
        
        # æª¢æŸ¥ 3: Checkpoint éºå¤±
        if not self.has_recent_checkpoint():
            self.alert("Missing checkpoint")
            return False
        
        return True
    
    def on_progress(self):
        self.last_progress_time = now()
        self.error_count = 0
    
    def on_error(self):
        self.error_count += 1
```

**Checkpoint ç­–ç•¥ï¼š**
```python
class CheckpointManager:
    def create_checkpoint(self, state):
        checkpoint = {
            'id': generate_id(),
            'timestamp': now(),
            'state': state,
            'files_modified': get_modified_files(),
            'rollback_script': generate_rollback()
        }
        save_to_external_db(checkpoint)
        return checkpoint['id']
    
    def rollback(self, checkpoint_id):
        checkpoint = load_from_external_db(checkpoint_id)
        execute_script(checkpoint['rollback_script'])
        restore_state(checkpoint['state'])
```

**Self-test æµç¨‹ï¼š**
```
æ¯æ¬¡è®Šæ›´
    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Sandbox ç’°å¢ƒ  â”‚
â”‚ â€¢ éš”é›¢åŸ·è¡Œ    â”‚
â”‚ â€¢ æ¨¡æ“¬è³‡æ–™    â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
       â†“
åŸ·è¡Œ Unit Tests
       â†“
åŸ·è¡Œ Integration Tests
       â†“
REPL é©—è­‰ï¼ˆèªæ³•æª¢æŸ¥ï¼‰
       â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ å…¨éƒ¨é€šéï¼Ÿâ”‚
â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜
     â”œâ”€ æ˜¯ â†’ æ¨åˆ°çœŸå¯¦ç’°å¢ƒ â†’ å»ºç«‹ Checkpoint
     â””â”€ å¦ â†’ è¨˜éŒ„éŒ¯èª¤ â†’ å›æ»¾ â†’ é‡è©¦æˆ– Alert
```

---

## æŠ€è¡“å¯¦ç¾

### èªè¨€èˆ‡è¨Šæ¯å¯†åº¦

**ç‚ºä½•é¸æ“‡ç¹é«”ä¸­æ–‡ç‚ºé è¨­ï¼Ÿ**

è¨Šæ¯å¯†åº¦å°æ¯”ï¼ˆç›¸åŒèªç¾©ï¼‰ï¼š
```
è‹±æ–‡ï¼ˆ48 å­—å…ƒï¼‰ï¼š
"Please execute the refactoring of this module"

ç¹é«”ä¸­æ–‡ï¼ˆ12 å­—å…ƒï¼‰ï¼š
"è«‹åŸ·è¡Œæ­¤æ¨¡çµ„é‡æ§‹"

è¨Šæ¯å¯†åº¦ï¼šä¸­æ–‡ = è‹±æ–‡çš„ 4 å€
```

**å°ˆæ¥­è¡“èªè™•ç†ï¼š**
```
ä¿ç•™è‹±æ–‡åŸæ–‡ + æ‹¬è™Ÿä¸­æ–‡èªªæ˜

ç¯„ä¾‹ï¼š
"ä½¿ç”¨ refactoringï¼ˆé‡æ§‹ï¼‰å„ªåŒ– codebaseï¼ˆä»£ç¢¼åº«ï¼‰"

å„ªå‹¢ï¼š
âœ“ ä¿æŒå°ˆæ¥­æ€§ï¼ˆé¿å…èª¤è­¯ï¼‰
âœ“ æå‡å¯è®€æ€§ï¼ˆä¸­æ–‡èªªæ˜ï¼‰
âœ“ é™ä½å­¸ç¿’é–€æª»
```

---

### æˆæ¬Šè©æª¢æ¸¬

**å¯¦ç¾æ–¹å¼ï¼ˆå½ä»£ç¢¼ï¼‰ï¼š**
```python
class TriggerDetector:
    SOLO_TRIGGERS = {
        'zh': ['é€²å…¥ Solo æ¨¡å¼', 'è«‹è‡ªä¸»åŸ·è¡Œ', 'è‡ªå‹•å®Œæˆ'],
        'en': ['enter solo mode', 'run autonomously', 'auto complete']
    }
    
    ACTION_TRIGGERS = {
        'zh': ['è«‹åŸ·è¡Œ', 'é–‹å§‹ä¿®æ”¹', 'è«‹å¹«æˆ‘å¯¦ä½œ'],
        'en': ['implement', 'execute', 'apply changes', 'do it']
    }
    
    def detect_mode(self, user_input):
        # å„ªå…ˆæª¢æ¸¬ Soloï¼ˆé–€æª»æœ€é«˜ï¼‰
        if any(trigger in user_input.lower() 
               for triggers in self.SOLO_TRIGGERS.values() 
               for trigger in triggers):
            return 'SOLO'
        
        # æ¬¡ç´šæª¢æ¸¬ Action
        if any(trigger in user_input.lower() 
               for triggers in self.ACTION_TRIGGERS.values() 
               for trigger in triggers):
            return 'ACTION'
        
        # é è¨­ Query
        return 'QUERY'
```

---

### Audit Log æ ¼å¼

**JSON Schemaï¼š**
```json
{
  "log_id": "uuid-v4",
  "timestamp": "2025-12-17T14:30:00Z",
  "mode": "ACTION | SOLO",
  "model": "gpt-5.2",
  "user_input": "è«‹åŸ·è¡Œé‡æ§‹",
  "intent": "refactor module X",
  "risk_level": "A | B | C",
  "changes": [
    {
      "file": "src/module.js",
      "operation": "modify | create | delete",
      "lines_changed": 42
    }
  ],
  "checkpoint_id": "checkpoint_001",
  "validation": {
    "unit_tests": "pass | fail",
    "integration_tests": "pass | fail"
  },
  "result": "success | failure | rollback",
  "error_message": null
}
```

---

## å®‰å…¨æ©Ÿåˆ¶

### é˜²ç¦¦å±¤ç´š

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Layer 1: è§¸ç™¼è©æª¢æ¸¬ï¼ˆèªç¾©å±¤ï¼‰        â”‚
â”‚  â€¢ æ˜ç¢ºæˆæ¬Šè©æ‰é€²å…¥åŸ·è¡Œæ¨¡å¼           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Layer 2: é åŸ·è¡Œç¢ºèªï¼ˆäº’å‹•å±¤ï¼‰        â”‚
â”‚  â€¢ é‡è¿°ç›®çš„ã€åˆ—å‡ºè®Šæ›´ã€æ¨™ç¤ºé¢¨éšª       â”‚
â”‚  â€¢ ç­‰å¾…äºŒæ¬¡ç¢ºèª                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Layer 3: é¢¨éšªåˆ†ç´šï¼ˆè©•ä¼°å±¤ï¼‰         â”‚
â”‚  â€¢ A/B/C åˆ¤æº–è‡ªå‹•è©•ä¼°                â”‚
â”‚  â€¢ C é¡ç›´æ¥æ‹’çµ•                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Layer 4: Sandbox é©—è­‰ï¼ˆåŸ·è¡Œå±¤ï¼‰     â”‚
â”‚  â€¢ å…ˆåœ¨éš”é›¢ç’°å¢ƒåŸ·è¡Œ                  â”‚
â”‚  â€¢ Self-test é€šéæ‰æ¨çœŸå¯¦ç’°å¢ƒ        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Layer 5: Checkpoint & Auditï¼ˆè¿½æº¯å±¤ï¼‰â”‚
â”‚  â€¢ æ‰€æœ‰è®Šæ›´å¯å›æ»¾                    â”‚
â”‚  â€¢ å®Œæ•´æ—¥èªŒä¾›å¯©è¨ˆ                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## æ•ˆèƒ½å„ªåŒ–

### Solo æ¨¡å¼å„ªåŒ–ç­–ç•¥

**1. å¹³è¡ŒåŒ–è™•ç†ï¼š**
```python
# å°‡ä»»å‹™æ‹†åˆ†ç‚ºå¯å¹³è¡ŒåŸ·è¡Œçš„å­ä»»å‹™
tasks = split_into_subtasks(main_task)
results = parallel_execute(tasks, max_workers=4)
```

**2. æ‰¹æ¬¡ Checkpointï¼š**
```python
# é¿å…æ¯æ¬¡è®Šæ›´éƒ½å»º checkpointï¼ˆæ•ˆèƒ½é–‹éŠ·å¤§ï¼‰
# æ”¹ç‚ºæ¯ N å€‹æª”æ¡ˆå»ºä¸€æ¬¡
if files_processed % 10 == 0:
    create_checkpoint(current_state)
```

**3. å¿«å–é©—è­‰çµæœï¼š**
```python
# è‹¥æª”æ¡ˆæœªè®Šæ›´ï¼Œé‡ç”¨ä¹‹å‰çš„æ¸¬è©¦çµæœ
test_cache = {}
if file_hash in test_cache:
    return test_cache[file_hash]
```

---

## æ“´å±•æ€§

### è‡ªå®šç¾©æ¨¡å¼

æ¡†æ¶æ”¯æ´æ–°å¢è‡ªå®šç¾©æ¨¡å¼ï¼š

```python
class CustomMode(BaseMode):
    TRIGGERS = ['custom trigger']
    
    def execute(self, user_input):
        # è‡ªå®šç¾©é‚è¼¯
        pass
```

### æ•´åˆå¤–éƒ¨ç³»çµ±

**ç¯„ä¾‹ï¼šä¼æ¥­å¯©æ‰¹ç³»çµ±æ•´åˆ**
```python
class EnterpriseActionMode(ActionMode):
    def pre_execution_check(self, changes):
        risk = self.assess_risk(changes)
        
        if risk in ['B', 'C']:
            # å‘¼å«å¤–éƒ¨å¯©æ‰¹ API
            approval_id = request_approval(changes)
            wait_for_approval(approval_id)
        
        return super().pre_execution_check(changes)
```

---

## ç‰ˆæœ¬æ¼”é€²

### v1.0ï¼ˆç•¶å‰ï¼‰
- âœ… ä¸‰æ¨¡å¼åŸºç¤æ¶æ§‹
- âœ… A/B/C é¢¨éšªåˆ†ç´š
- âœ… ç¹é«”ä¸­æ–‡é è¨­
- âœ… å¤šä»»å‹™ç®¡ç†æ©Ÿåˆ¶ï¼ˆTASK_TRACKER.mdï¼‰
- âœ… Checkpoint & Audit log

### v1.1ï¼ˆè¦åŠƒä¸­ï¼‰
- ğŸ”„ MCPï¼ˆModel Context Protocolï¼‰æ•´åˆ
- ğŸ”„ Draw.io æµç¨‹åœ–æ”¯æ´
- ğŸ”„ å¤š Agent å”ä½œæ”¯æ´
- ğŸ”„ æ›´ç´°ç·»çš„é¢¨éšªåˆ†ç´šï¼ˆA1/A2/B1/B2ï¼‰
- ğŸ”„ Web UI æ§åˆ¶é¢æ¿

### v2.0ï¼ˆæœªä¾†ï¼‰
- ğŸ’¡ AI è‡ªä¸»å­¸ç¿’é¢¨éšªåˆ¤æº–
- ğŸ’¡ è‡ªå‹•ç”¢ç”Ÿæœ€ä½³å¯¦è¸å»ºè­°
- ğŸ’¡ è·¨èªè¨€ç„¡ç¸«åˆ‡æ›

---

## åƒè€ƒè³‡æ–™

- [README.md](../../README.md)
- [TASK_TRACKER.md](../TASK_TRACKER.md)
- [System Prompt å®Œæ•´ç‰ˆ](../prompts/full-solo.md)
- [é¢¨éšªçŸ©é™£](./risk-matrix.md)
- [ä½¿ç”¨æ¡ˆä¾‹](./use-cases.md)
- [æ•´åˆç¯„ä¾‹](../integration/)

---

**æœ€å¾Œæ›´æ–°**ï¼š2025-12-17  
**æ¡†æ¶ç‰ˆæœ¬**ï¼šQuery/Action/Solo v1.0
